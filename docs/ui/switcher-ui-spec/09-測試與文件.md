# éšæ®µ 9ï¸âƒ£: æ¸¬è©¦èˆ‡æ–‡ä»¶

## ğŸ¯ ç›®æ¨™

å®Œå–„æ¸¬è©¦è¦†è“‹ç‡ä¸¦å»ºç«‹æ–‡ä»¶:
- å–®å…ƒæ¸¬è©¦ (Component & Store)
- æ•´åˆæ¸¬è©¦
- E2E æ¸¬è©¦
- Storybook æ–‡ä»¶

**é ä¼°æ™‚é–“**: 4-5 å°æ™‚

---

## ğŸ“ æ­¥é©Ÿ 1: å–®å…ƒæ¸¬è©¦

### 1.1 Store æ¸¬è©¦

```typescript
// global-shell.store.spec.ts
import { TestBed } from '@angular/core/testing';
import { AccountStore } from './global-shell.store';

describe('AccountStore', () => {
  let store: InstanceType<typeof AccountStore>;
  
  beforeEach(() => {
    TestBed.configureTestingModule({
      providers: [AccountStore]
    });
    
    store = TestBed.inject(AccountStore);
  });
  
  it('æ‡‰è©²å»ºç«‹ store', () => {
    expect(store).toBeTruthy();
  });
  
  it('æ‡‰è©²è¼‰å…¥ç•¶å‰å¸³è™Ÿ', (done) => {
    const accountId = 'test-account-1';
    
    store.loadCurrentAccount(accountId);
    
    // é©—è­‰è¼‰å…¥ç‹€æ…‹
    expect(store.isLoading()).toBe(true);
    
    // ç­‰å¾…éåŒæ­¥å®Œæˆ
    setTimeout(() => {
      expect(store.account()).toBeTruthy();
      expect(store.isLoading()).toBe(false);
      done();
    }, 100);
  });
});
```

### 1.2 çµ„ä»¶æ¸¬è©¦

```typescript
// account-switcher.component.spec.ts
import { ComponentFixture, TestBed } from '@angular/core/testing';
import { AccountSwitcherComponent } from './account-switcher.component';

describe('AccountSwitcherComponent', () => {
  let component: AccountSwitcherComponent;
  let fixture: ComponentFixture<AccountSwitcherComponent>;
  
  beforeEach(async () => {
    await TestBed.configureTestingModule({
      imports: [AccountSwitcherComponent]
    }).compileComponents();
    
    fixture = TestBed.createComponent(AccountSwitcherComponent);
    component = fixture.componentInstance;
    fixture.detectChanges();
  });
  
  it('æ‡‰è©²å»ºç«‹çµ„ä»¶', () => {
    expect(component).toBeTruthy();
  });
  
  it('æ‡‰è©²é¡¯ç¤ºç•¶å‰å¸³è™Ÿåç¨±', () => {
    const compiled = fixture.nativeElement;
    const accountName = compiled.querySelector('.account-name');
    
    expect(accountName.textContent).toContain('Demo User');
  });
  
  it('é»æ“Šæ‡‰è©²é–‹å•Ÿé¸å–®', () => {
    const trigger = fixture.nativeElement.querySelector('.account-trigger');
    trigger.click();
    
    fixture.detectChanges();
    
    expect(component.isMenuOpen()).toBe(true);
  });
});
```

---

## ğŸ“ æ­¥é©Ÿ 2: æ•´åˆæ¸¬è©¦

### 2.1 åˆ‡æ›æµç¨‹æ¸¬è©¦

```typescript
// workspace-switcher.integration.spec.ts
describe('WorkspaceSwitcher Integration', () => {
  it('æ‡‰è©²å®Œæ•´åŸ·è¡Œåˆ‡æ›å·¥ä½œå€æµç¨‹', async () => {
    const { fixture, component } = await setup();
    
    // 1. é–‹å•Ÿé¸å–®
    const trigger = fixture.nativeElement.querySelector('.workspace-trigger');
    trigger.click();
    fixture.detectChanges();
    
    // 2. é¸æ“‡å·¥ä½œå€
    const workspaceItem = fixture.nativeElement.querySelector('.workspace-item');
    workspaceItem.click();
    fixture.detectChanges();
    
    // 3. é©—è­‰åˆ‡æ›æˆåŠŸ
    expect(component.workspaceList.currentWorkspaceId()).toBe('workspace-1');
    
    // 4. é©—è­‰ URL æ›´æ–°
    expect(router.url).toContain('/workspace/workspace-1');
  });
});
```

---

## ğŸ“ æ­¥é©Ÿ 3: E2E æ¸¬è©¦

### 3.1 Playwright æ¸¬è©¦

```typescript
// workspace-switcher.e2e.spec.ts
import { test, expect } from '@playwright/test';

test.describe('å·¥ä½œå€åˆ‡æ›å™¨', () => {
  test('ä½¿ç”¨è€…å¯ä»¥åˆ‡æ›å·¥ä½œå€', async ({ page }) => {
    await page.goto('/');
    
    // é»æ“Šåˆ‡æ›å™¨
    await page.click('.workspace-trigger');
    
    // ç­‰å¾…é¸å–®å‡ºç¾
    await page.waitForSelector('.workspace-menu');
    
    // é¸æ“‡å·¥ä½œå€
    await page.click('.workspace-item:first-child');
    
    // é©—è­‰ URL
    await expect(page).toHaveURL(/\/workspace\/.+/);
    
    // é©—è­‰åˆ‡æ›æˆåŠŸæç¤º
    await expect(page.locator('.mat-snack-bar-container'))
      .toContainText('å·²åˆ‡æ›');
  });
  
  test('ä½¿ç”¨è€…å¯ä»¥ä½¿ç”¨å¿«æ·éµé–‹å•Ÿå‘½ä»¤é¢æ¿', async ({ page }) => {
    await page.goto('/');
    
    // æŒ‰ä¸‹ Ctrl+K
    await page.keyboard.press('Control+K');
    
    // é©—è­‰å‘½ä»¤é¢æ¿é–‹å•Ÿ
    await expect(page.locator('.command-palette')).toBeVisible();
  });
});
```

---

## ğŸ“ æ­¥é©Ÿ 4: Storybook æ–‡ä»¶

### 4.1 Stories è¨­å®š

```typescript
// account-switcher.stories.ts
import type { Meta, StoryObj } from '@storybook/angular';
import { AccountSwitcherComponent } from './account-switcher.component';

const meta: Meta<AccountSwitcherComponent> = {
  title: 'Navigation/AccountSwitcher',
  component: AccountSwitcherComponent,
  tags: ['autodocs']
};

export default meta;
type Story = StoryObj<AccountSwitcherComponent>;

export const Default: Story = {};

export const WithMultipleAccounts: Story = {
  // Mock å¤šå€‹å¸³è™Ÿ
};

export const Loading: Story = {
  // Mock è¼‰å…¥ç‹€æ…‹
};

export const Mobile: Story = {
  parameters: {
    viewport: { defaultViewport: 'mobile1' }
  }
};
```

---

## ğŸ“ æ­¥é©Ÿ 5: ä½¿ç”¨æ–‡ä»¶

### 5.1 README.md

```markdown
# åˆ‡æ›å™¨ä½¿ç”¨æŒ‡å—

## èº«ä»½åˆ‡æ›å™¨

### åŠŸèƒ½
- åœ¨ä¸åŒèº«ä»½(User/Organization/Team/Partner)é–“åˆ‡æ›
- å¿«æ·éµ: `Ctrl+Shift+A`

### ä½¿ç”¨æ–¹å¼
1. é»æ“Šå³ä¸Šè§’èº«ä»½æŒ‰éˆ•
2. é¸æ“‡ç›®æ¨™èº«ä»½
3. ç¢ºèªåˆ‡æ›æˆåŠŸæç¤º

## å·¥ä½œå€åˆ‡æ›å™¨

### åŠŸèƒ½
- å¿«é€Ÿåˆ‡æ›å·¥ä½œå€
- æœå°‹å·¥ä½œå€
- æˆ‘çš„æœ€æ„›ç®¡ç†
- å¿«æ·éµ: `Ctrl+K`

### ä½¿ç”¨æ–¹å¼
1. é»æ“Šå·¦ä¸Šè§’å·¥ä½œå€æŒ‰éˆ•
2. æœå°‹æˆ–é¸æ“‡å·¥ä½œå€
3. ç¢ºèªåˆ‡æ›
```

---

## âœ… å®Œæˆæª¢æŸ¥æ¸…å–®

### æ¸¬è©¦
- [ ] å–®å…ƒæ¸¬è©¦è¦†è“‹ç‡ > 80%
- [ ] Store æ¸¬è©¦é€šé
- [ ] çµ„ä»¶æ¸¬è©¦é€šé
- [ ] æ•´åˆæ¸¬è©¦é€šé
- [ ] E2E æ¸¬è©¦é€šé

### æ–‡ä»¶
- [ ] README å®Œæ•´
- [ ] Storybook è¨­å®š
- [ ] API æ–‡ä»¶
- [ ] ä½¿ç”¨èªªæ˜

### å“è³ª
- [ ] ESLint ç„¡éŒ¯èª¤
- [ ] TypeScript ç„¡éŒ¯èª¤
- [ ] ç„¡ Console è­¦å‘Š
- [ ] ç„¡éšœç¤™æª¢æŸ¥é€šé

---

## ğŸ‰ æ­å–œå®Œæˆ!

æ‚¨å·²å®Œæˆæ‰€æœ‰ 9 å€‹éšæ®µçš„é–‹ç™¼!

ç¾åœ¨æ‚¨æ“æœ‰:
âœ… åŠŸèƒ½å®Œæ•´çš„èº«ä»½åˆ‡æ›å™¨
âœ… åŠŸèƒ½å®Œæ•´çš„å·¥ä½œå€åˆ‡æ›å™¨  
âœ… éŸ¿æ‡‰å¼è¨­è¨ˆ
âœ… ç„¡éšœç¤™æ”¯æ´
âœ… æ•ˆèƒ½å„ªåŒ–
âœ… å®Œæ•´æ¸¬è©¦è¦†è“‹
âœ… è©³ç´°æ–‡ä»¶

### ä¸‹ä¸€æ­¥å»ºè­°
1. éƒ¨ç½²åˆ°æ¸¬è©¦ç’°å¢ƒ
2. æ”¶é›†ä½¿ç”¨è€…å›é¥‹
3. æŒçºŒå„ªåŒ–æ•ˆèƒ½
4. æ–°å¢æ›´å¤šé€²éšåŠŸèƒ½
