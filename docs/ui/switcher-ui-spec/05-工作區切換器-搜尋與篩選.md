# éšæ®µ 5ï¸âƒ£: å·¥ä½œå€åˆ‡æ›å™¨ - æœå°‹èˆ‡ç¯©é¸

## ğŸ¯ ç›®æ¨™

æ–°å¢é€²éšåŠŸèƒ½:
- æœå°‹æ¡†èˆ‡å³æ™‚æœå°‹
- æˆ‘çš„æœ€æ„›åŠŸèƒ½
- å·²å°å­˜å·¥ä½œå€å±•é–‹/æ”¶åˆ
- éµç›¤å°èˆª

**é ä¼°æ™‚é–“**: 3-4 å°æ™‚

---

## ğŸ“ æ­¥é©Ÿ 1: æ–°å¢æœå°‹æ¡†

### 1.1 æ›´æ–°æ¨¡æ¿

```html
<!-- åœ¨é¸å–®é ‚éƒ¨æ–°å¢æœå°‹æ¡† -->
<mat-menu #workspaceMenu="matMenu" class="workspace-menu">
  <!-- æœå°‹æ¡† -->
  <div class="search-container" (click)="$event.stopPropagation()">
    <mat-form-field appearance="outline" class="search-field">
      <mat-icon matPrefix>search</mat-icon>
      <input
        matInput
        placeholder="æœå°‹å·¥ä½œå€..."
        [(ngModel)]="searchQuery"
        (ngModelChange)="onSearchChange($event)"
        #searchInput>
      @if (searchQuery()) {
        <button
          matSuffix
          mat-icon-button
          (click)="clearSearch()">
          <mat-icon>close</mat-icon>
        </button>
      }
    </mat-form-field>
  </div>
  
  <!-- å…¶é¤˜é¸å–®å…§å®¹ -->
</mat-menu>
```

### 1.2 çµ„ä»¶é‚è¼¯

```typescript
// workspace-switcher.component.ts
import { FormsModule } from '@angular/forms';
import { MatFormFieldModule } from '@angular/material/form-field';
import { MatInputModule } from '@angular/material/input';
import { Subject } from 'rxjs';
import { debounceTime, distinctUntilChanged } from 'rxjs/operators';

export class WorkspaceSwitcherComponent implements OnInit, OnDestroy {
  @ViewChild('searchInput') searchInput?: ElementRef<HTMLInputElement>;
  
  protected searchQuery = signal('');
  private searchSubject = new Subject<string>();
  
  ngOnInit(): void {
    // æœå°‹é˜²æŠ–
    this.searchSubject
      .pipe(
        debounceTime(300),
        distinctUntilChanged(),
        takeUntilDestroyed(this.destroyRef)
      )
      .subscribe((query) => {
        this.workspaceList.setSearchQuery(query);
      });
  }
  
  onSearchChange(query: string): void {
    this.searchSubject.next(query);
  }
  
  clearSearch(): void {
    this.searchQuery.set('');
    this.workspaceList.setSearchQuery('');
  }
  
  onMenuOpened(): void {
    // è‡ªå‹• focus æœå°‹æ¡†
    setTimeout(() => {
      this.searchInput?.nativeElement.focus();
    }, 100);
  }
}
```

---

## ğŸ“ æ­¥é©Ÿ 2: æˆ‘çš„æœ€æ„›åŠŸèƒ½

### 2.1 æ–°å¢æˆ‘çš„æœ€æ„›åœ–ç¤º

```html
<!-- åœ¨å·¥ä½œå€é …ç›®ä¸­æ–°å¢æ˜Ÿè™ŸæŒ‰éˆ• -->
<div class="workspace-item-content">
  <!-- ... ç¾æœ‰å…§å®¹ -->
  
  <button
    mat-icon-button
    class="favorite-button"
    (click)="onToggleFavorite($event, workspace.id)"
    [attr.aria-label]="isFavorite(workspace.id) ? 'å–æ¶ˆæœ€æ„›' : 'åŠ å…¥æœ€æ„›'">
    <mat-icon [class.favorited]="isFavorite(workspace.id)">
      {{ isFavorite(workspace.id) ? 'star' : 'star_border' }}
    </mat-icon>
  </button>
  
  @if (workspace.id === currentWorkspace()?.id) {
    <mat-icon class="check-icon">check</mat-icon>
  }
</div>
```

### 2.2 çµ„ä»¶æ–¹æ³•

```typescript
protected isFavorite(workspaceId: string): boolean {
  return this.workspaceList.favorites().includes(workspaceId);
}

protected onToggleFavorite(event: Event, workspaceId: string): void {
  event.stopPropagation();
  this.workspaceList.toggleFavorite(workspaceId);
}
```

### 2.3 æ¨£å¼

```scss
.favorite-button {
  width: 32px;
  height: 32px;
  
  mat-icon {
    font-size: 20px;
    color: rgba(0, 0, 0, 0.38);
    transition: all 200ms ease;
    
    &.favorited {
      color: #ffc107;
    }
  }
  
  &:hover mat-icon {
    color: #ffc107;
  }
}
```

---

## ğŸ“ æ­¥é©Ÿ 3: å·²å°å­˜å±•é–‹/æ”¶åˆ

### 3.1 æ–°å¢å±•é–‹ç‹€æ…‹

```typescript
protected showArchived = signal(false);

protected archivedWorkspaces = computed(() => {
  return this.workspaceList.archivedWorkspaces();
});

protected toggleArchived(): void {
  this.showArchived.update(v => !v);
}
```

### 3.2 æ¨¡æ¿

```html
<!-- å·²å°å­˜å€å¡Š -->
<div class="menu-section archived-section">
  <button
    mat-button
    class="section-header"
    (click)="toggleArchived()">
    <span class="section-title">å·²å°å­˜ ({{ archivedWorkspaces().length }})</span>
    <mat-icon class="expand-icon" [class.expanded]="showArchived()">
      expand_more
    </mat-icon>
  </button>
  
  @if (showArchived()) {
    @for (workspace of archivedWorkspaces(); track workspace.id) {
      <!-- å·¥ä½œå€é …ç›® -->
    }
  }
</div>
```

---

## âœ… é©—è­‰æ¸…å–®

- [ ] æœå°‹æ¡†å³æ™‚ç¯©é¸å·¥ä½œå€
- [ ] æˆ‘çš„æœ€æ„›åœ–ç¤ºå¯åˆ‡æ›
- [ ] å·²å°å­˜å€å¡Šå¯å±•é–‹/æ”¶åˆ
- [ ] éµç›¤ â†‘â†“ å¯å°èˆª
- [ ] Enter å¯é¸æ“‡å·¥ä½œå€

---

## â­ï¸ ä¸‹ä¸€æ­¥

ç¹¼çºŒ **éšæ®µ 6: å‘½ä»¤é¢æ¿æ¨¡å¼**
