# éšæ®µ 4ï¸âƒ£: å·¥ä½œå€åˆ‡æ›å™¨ - åŸºç¤çµ„ä»¶

## ğŸ¯ ç›®æ¨™

å¯¦ä½œå·¥ä½œå€åˆ‡æ›å™¨çš„æ ¸å¿ƒ UI:
- è§¸ç™¼æŒ‰éˆ• (å¸¶å·¥ä½œå€åœ–ç¤º)
- ä¸‹æ‹‰é¸å–®åŸºæœ¬çµæ§‹
- å·¥ä½œå€é …ç›®æ¨£å¼
- é¡å‹é¡è‰²ç³»çµ±

**é ä¼°æ™‚é–“**: 3-4 å°æ™‚

---

## ğŸ“ æ­¥é©Ÿ 1: å»ºç«‹çµ„ä»¶

```bash
ng generate component presentation/layouts/header/components/workspace-switcher --standalone
```

### 1.1 TypeScript

```typescript
// workspace-switcher.component.ts
import { Component, computed, inject, signal } from '@angular/core';
import { CommonModule } from '@angular/common';
import { MatButtonModule } from '@angular/material/button';
import { MatMenuModule } from '@angular/material/menu';
import { MatIconModule } from '@angular/material/icon';
import { MatDividerModule } from '@angular/material/divider';

import { WorkspaceStore } from '@/application/store/workspace';
import { WorkspaceType } from '@/domain/workspace/entities';

@Component({
  selector: 'app-workspace-switcher',
  standalone: true,
  imports: [
    CommonModule,
    MatButtonModule,
    MatMenuModule,
    MatIconModule,
    MatDividerModule
  ],
  templateUrl: './workspace-switcher.component.html',
  styleUrl: './workspace-switcher.component.scss'
})
export class WorkspaceSwitcherComponent {
  protected workspaceStore = inject(WorkspaceStore);
  protected isMenuOpen = signal(false);
  
  protected readonly WorkspaceType = WorkspaceType;
  
  protected currentWorkspace = this.workspaceStore.currentWorkspace;
  protected groupedWorkspaces = this.workspaceStore.groupedWorkspaces;
  
  /**
   * å–å¾—å·¥ä½œå€é¡å‹æ¼¸å±¤è‰²
   */
  getWorkspaceGradient(type: WorkspaceType): string {
    const gradients = {
      [WorkspaceType.Project]: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
      [WorkspaceType.Department]: 'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)',
      [WorkspaceType.Client]: 'linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)',
      [WorkspaceType.Campaign]: 'linear-gradient(135deg, #fa709a 0%, #fee140 100%)',
      [WorkspaceType.Product]: 'linear-gradient(135deg, #30cfd0 0%, #330867 100%)',
      [WorkspaceType.Internal]: 'linear-gradient(135deg, #a8edea 0%, #fed6e3 100%)'
    };
    
    return gradients[type] || gradients[WorkspaceType.Project];
  }
  
  /**
   * åˆ‡æ›å·¥ä½œå€
   */
  onSwitchWorkspace(workspaceId: string): void {
    if (workspaceId === this.currentWorkspace()?.id) return;
    
    this.workspaceStore.setCurrentWorkspace(workspaceId);
  }
  
  /**
   * å»ºç«‹æ–°å·¥ä½œå€
   */
  onCreateWorkspace(): void {
    console.log('å»ºç«‹æ–°å·¥ä½œå€');
  }
}
```

### 1.2 HTML

```html
<!-- workspace-switcher.component.html -->

<button
  mat-button
  class="workspace-trigger"
  [matMenuTriggerFor]="workspaceMenu"
  (menuOpened)="isMenuOpen.set(true)"
  (menuClosed)="isMenuOpen.set(false)">
  
  @if (currentWorkspace(); as workspace) {
    <!-- å·¥ä½œå€åœ–ç¤º -->
    <div
      class="workspace-icon"
      [style.background]="getWorkspaceGradient(workspace.type)">
      @if (workspace.avatar) {
        <img [src]="workspace.avatar" [alt]="workspace.name">
      } @else {
        <span class="workspace-letter">
          {{ workspace.name.charAt(0).toUpperCase() }}
        </span>
      }
    </div>
    
    <!-- å·¥ä½œå€åç¨± -->
    <span class="workspace-name">{{ workspace.name }}</span>
    
    <!-- ä¸‹æ‹‰åœ–ç¤º -->
    <mat-icon
      class="dropdown-icon"
      [class.rotated]="isMenuOpen()">
      unfold_more
    </mat-icon>
  } @else {
    <span>é¸æ“‡å·¥ä½œå€</span>
  }
</button>

<!-- ä¸‹æ‹‰é¸å–® -->
<mat-menu
  #workspaceMenu="matMenu"
  class="workspace-menu">
  
  @for (group of groupedWorkspaces(); track group.title) {
    <div class="menu-section">
      <div class="section-title">{{ group.title }}</div>
      
      @for (workspace of group.workspaces; track workspace.id) {
        <button
          mat-menu-item
          class="workspace-item"
          [class.active]="workspace.id === currentWorkspace()?.id"
          (click)="onSwitchWorkspace(workspace.id)">
          
          <div class="workspace-item-content">
            <!-- åœ–ç¤º -->
            <div
              class="item-icon"
              [style.background]="getWorkspaceGradient(workspace.type)">
              @if (workspace.avatar) {
                <img [src]="workspace.avatar" [alt]="workspace.name">
              } @else {
                <span class="icon-letter">
                  {{ workspace.name.charAt(0).toUpperCase() }}
                </span>
              }
            </div>
            
            <!-- è³‡è¨Š -->
            <div class="item-info">
              <div class="item-name">{{ workspace.name }}</div>
              <div class="item-meta">
                {{ workspace.type }} Â· {{ workspace.memberCount }} members
              </div>
            </div>
            
            <!-- å‹¾é¸ -->
            @if (workspace.id === currentWorkspace()?.id) {
              <mat-icon class="check-icon">check</mat-icon>
            }
          </div>
        </button>
      }
    </div>
    
    <mat-divider></mat-divider>
  }
  
  <!-- å»ºç«‹æ–°å·¥ä½œå€ -->
  <button
    mat-menu-item
    class="create-workspace"
    (click)="onCreateWorkspace()">
    <mat-icon>add</mat-icon>
    <span>å»ºç«‹æ–°å·¥ä½œå€</span>
  </button>
</mat-menu>
```

### 1.3 SCSS

```scss
// workspace-switcher.component.scss

.workspace-trigger {
  display: flex;
  align-items: center;
  gap: 12px;
  height: 48px;
  padding: 8px 16px;
  border-radius: 8px;
  border: 1px solid rgba(0, 0, 0, 0.12);
  background: transparent;
  transition: all 200ms ease;
  
  &:hover {
    background: rgba(0, 0, 0, 0.04);
    border-color: rgba(0, 0, 0, 0.24);
  }
  
  .workspace-icon {
    width: 24px;
    height: 24px;
    border-radius: 4px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    overflow: hidden;
    
    img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    
    .workspace-letter {
      color: white;
      font-size: 14px;
      font-weight: 600;
    }
  }
  
  .workspace-name {
    font-size: 16px;
    font-weight: 600;
    color: rgba(0, 0, 0, 0.87);
    max-width: 200px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }
  
  .dropdown-icon {
    width: 20px;
    height: 20px;
    font-size: 20px;
    transition: transform 200ms ease;
    
    &.rotated {
      transform: rotate(180deg);
    }
  }
}

::ng-deep .workspace-menu {
  .mat-mdc-menu-panel {
    width: 360px;
    max-height: 480px;
    border-radius: 12px;
  }
}

.menu-section {
  .section-title {
    font-size: 12px;
    font-weight: 500;
    color: rgba(0, 0, 0, 0.6);
    text-transform: uppercase;
    letter-spacing: 0.5px;
    padding: 8px 16px;
  }
}

.workspace-item {
  height: 64px !important;
  padding: 12px 16px !important;
  
  &.active {
    background: rgba(63, 81, 181, 0.08);
  }
  
  .workspace-item-content {
    display: flex;
    align-items: center;
    gap: 12px;
    width: 100%;
    
    .item-icon {
      width: 40px;
      height: 40px;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      overflow: hidden;
      
      img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }
      
      .icon-letter {
        color: white;
        font-size: 18px;
        font-weight: 600;
      }
    }
    
    .item-info {
      flex: 1;
      min-width: 0;
      
      .item-name {
        font-size: 14px;
        font-weight: 500;
        color: rgba(0, 0, 0, 0.87);
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
      }
      
      .item-meta {
        font-size: 12px;
        color: rgba(0, 0, 0, 0.6);
        text-transform: capitalize;
      }
    }
    
    .check-icon {
      color: #3f51b5;
    }
  }
}

.create-workspace {
  display: flex;
  align-items: center;
  gap: 12px;
  
  mat-icon {
    color: #3f51b5;
  }
}
```

---

## âœ… é©—è­‰æ¸…å–®

- [ ] è§¸ç™¼æŒ‰éˆ•é¡¯ç¤ºç•¶å‰å·¥ä½œå€
- [ ] é»æ“Šå¯é–‹å•Ÿé¸å–®
- [ ] å·¥ä½œå€æŒ‰åˆ†çµ„é¡¯ç¤º
- [ ] é¡å‹æ¼¸å±¤è‰²æ­£ç¢º
- [ ] åˆ‡æ›åŠŸèƒ½æ­£å¸¸

---

## â­ï¸ ä¸‹ä¸€æ­¥

ç¹¼çºŒ **éšæ®µ 5: å·¥ä½œå€åˆ‡æ›å™¨ - æœå°‹èˆ‡ç¯©é¸**
