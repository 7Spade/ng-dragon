# éšæ®µ 7ï¸âƒ£: éŸ¿æ‡‰å¼è¨­è¨ˆèˆ‡ç„¡éšœç¤™

## ğŸ¯ ç›®æ¨™

ç¢ºä¿åˆ‡æ›å™¨åœ¨å„ç¨®è£ç½®ä¸Šéƒ½èƒ½è‰¯å¥½é‹ä½œ:
- éŸ¿æ‡‰å¼æ–·é»è™•ç†
- ç§»å‹•ç«¯ Bottom Sheet
- ARIA å±¬æ€§
- éµç›¤å°èˆª

**é ä¼°æ™‚é–“**: 3-4 å°æ™‚

---

## ğŸ“ æ­¥é©Ÿ 1: éŸ¿æ‡‰å¼æ–·é»åµæ¸¬

### 1.1 ä½¿ç”¨ BreakpointObserver

```typescript
// account-switcher.component.ts
import { BreakpointObserver } from '@angular/cdk/layout';
import { BREAKPOINTS } from '@/shared/constants/breakpoints';

export class AccountSwitcherComponent implements OnInit {
  private breakpointObserver = inject(BreakpointObserver);
  
  protected isMobile = signal(false);
  protected isTablet = signal(false);
  
  ngOnInit(): void {
    // åµæ¸¬ç§»å‹•è£ç½®
    this.breakpointObserver
      .observe([BREAKPOINTS.mobile])
      .pipe(takeUntilDestroyed(this.destroyRef))
      .subscribe(result => {
        this.isMobile.set(result.matches);
      });
      
    // åµæ¸¬å¹³æ¿
    this.breakpointObserver
      .observe([BREAKPOINTS.tablet])
      .pipe(takeUntilDestroyed(this.destroyRef))
      .subscribe(result => {
        this.isTablet.set(result.matches);
      });
  }
}
```

### 1.2 éŸ¿æ‡‰å¼æ¨¡æ¿

```html
<!-- æ ¹æ“šè£ç½®é¡å‹èª¿æ•´é¡¯ç¤º -->
<button mat-button class="account-trigger">
  <div class="avatar-container">
    <!-- é ­åƒ -->
  </div>
  
  <!-- æ¡Œé¢:é¡¯ç¤ºåç¨± -->
  @if (!isMobile() && !isTablet()) {
    <span class="account-name">{{ displayName() }}</span>
  }
  
  <!-- å¹³æ¿/ç§»å‹•:éš±è—åç¨± -->
  
  @if (!isMobile()) {
    <mat-icon class="dropdown-icon">expand_more</mat-icon>
  }
</button>
```

---

## ğŸ“ æ­¥é©Ÿ 2: ç§»å‹•ç«¯ Bottom Sheet

### 2.1 ä½¿ç”¨ MatBottomSheet (ç§»å‹•ç«¯)

```typescript
// workspace-switcher.component.ts
import { MatBottomSheet } from '@angular/material/bottom-sheet';

export class WorkspaceSwitcherComponent {
  private bottomSheet = inject(MatBottomSheet);
  
  onTriggerClick(): void {
    if (this.isMobile()) {
      // ç§»å‹•ç«¯ä½¿ç”¨ Bottom Sheet
      this.bottomSheet.open(WorkspaceBottomSheetComponent);
    } else {
      // æ¡Œé¢ä½¿ç”¨ MatMenu
      this.menuTrigger.openMenu();
    }
  }
}
```

---

## ğŸ“ æ­¥é©Ÿ 3: ARIA ç„¡éšœç¤™å±¬æ€§

### 3.1 å®Œæ•´ ARIA æ¨™è¨˜

```html
<!-- è§¸ç™¼æŒ‰éˆ• -->
<button
  mat-button
  [matMenuTriggerFor]="accountMenu"
  role="button"
  aria-label="åˆ‡æ›èº«ä»½"
  aria-haspopup="true"
  [attr.aria-expanded]="isMenuOpen()"
  [attr.aria-controls]="isMenuOpen() ? 'account-menu' : null">
  <!-- å…§å®¹ -->
</button>

<!-- é¸å–® -->
<mat-menu
  #accountMenu="matMenu"
  id="account-menu"
  role="menu">
  
  <button
    mat-menu-item
    role="menuitem"
    [attr.aria-current]="isCurrentAccount(account.id) ? 'true' : null">
    <!-- å¸³è™Ÿé …ç›® -->
  </button>
</mat-menu>
```

### 3.2 è¢å¹•é–±è®€å™¨é€šçŸ¥

```typescript
// æ–°å¢ Live Region
@Component({
  template: `
    <div
      aria-live="polite"
      aria-atomic="true"
      class="sr-only">
      {{ announceMessage() }}
    </div>
  `
})
export class AccountSwitcherComponent {
  protected announceMessage = signal('');
  
  onSwitchAccount(account: Account): void {
    // åŸ·è¡Œåˆ‡æ›...
    
    // é€šçŸ¥è¢å¹•é–±è®€å™¨
    this.announceMessage.set(`å·²åˆ‡æ›è‡³ ${account.name}`);
    
    // æ¸…é™¤è¨Šæ¯
    setTimeout(() => this.announceMessage.set(''), 1000);
  }
}
```

---

## ğŸ“ æ­¥é©Ÿ 4: éµç›¤å°èˆªå¢å¼·

### 4.1 éµç›¤äº‹ä»¶è™•ç†

```typescript
@HostListener('keydown', ['$event'])
onKeyDown(event: KeyboardEvent): void {
  if (!this.isMenuOpen()) return;
  
  switch (event.key) {
    case 'Home':
      // è·³åˆ°ç¬¬ä¸€å€‹é …ç›®
      this.focusFirstItem();
      event.preventDefault();
      break;
      
    case 'End':
      // è·³åˆ°æœ€å¾Œä¸€å€‹é …ç›®
      this.focusLastItem();
      event.preventDefault();
      break;
  }
}
```

---

## âœ… é©—è­‰æ¸…å–®

- [ ] æ¡Œé¢ç‰ˆå®Œæ•´é¡¯ç¤º
- [ ] å¹³æ¿ç‰ˆéš±è—åç¨±
- [ ] ç§»å‹•ç‰ˆä½¿ç”¨ Bottom Sheet
- [ ] ARIA å±¬æ€§å®Œæ•´
- [ ] Tab éµå¯å°èˆª
- [ ] è¢å¹•é–±è®€å™¨æ­£å¸¸é‹ä½œ

---

## â­ï¸ ä¸‹ä¸€æ­¥

ç¹¼çºŒ **éšæ®µ 8: æ•ˆèƒ½å„ªåŒ–èˆ‡ç‹€æ…‹æŒä¹…åŒ–**
